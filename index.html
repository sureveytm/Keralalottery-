<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Kerala Government Ticket</title>
<style>
:root{--accent:#ff4f79;--accent-dark:#d9365d;--bg:#fff3f7;--card:#fff;}
body{margin:0;background:var(--bg);font-family:Arial,sans-serif;display:flex;justify-content:center;padding:8px;}
.container{width:100%;max-width:400px;background:var(--card);padding:14px;border-radius:14px;box-shadow:0 4px 8px rgba(0,0,0,.14);}
.topLogo img{width:130px;display:block;margin:0 auto 4px;}
.livePop{display:inline-block;padding:6px 14px;border-radius:20px;background:linear-gradient(90deg,#2ecc71,#27ae60);color:#fff;font-size:12px;font-weight:bold;animation:pulse 1.2s infinite;}
@keyframes pulse{0%{transform:scale(1);}50%{transform:scale(1.05);}100%{transform:scale(1);}}
.timerBar{background:#e8f5e9;color:#1b5e20;padding:6px;border-radius:8px;font-size:12px;text-align:center;font-weight:bold;margin-bottom:6px;}
h2{text-align:center;margin:6px 0;color:#d9365d;font-size:18px;}
input,select,button{width:100%;padding:9px;margin-bottom:8px;border-radius:8px;border:1px solid #ddd;font-size:13px;}
.ticketBox{border:2px dashed #ff4f79;border-radius:12px;padding:10px;margin-bottom:8px;}
.ticketAmount{background:#e8f5e9;color:#1b5e20;padding:6px;border-radius:8px;text-align:center;font-weight:bold;margin-bottom:6px;font-size:13px;}
.ticketTitle{font-weight:bold;color:#d9365d;margin-bottom:4px;font-size:13px;}
select[multiple]{height:55px;}
.counter{font-size:11px;margin-top:3px;}
.selectedList{display:flex;flex-wrap:wrap;gap:5px;margin-top:5px;}
.chip{background:#ffe3ea;color:#d9365d;padding:3px 7px;border-radius:10px;font-size:11px;display:flex;align-items:center;gap:5px;}
.chip span{cursor:pointer;font-weight:bold;}
button{background:linear-gradient(90deg,var(--accent),var(--accent-dark));color:#fff;border:none;font-weight:bold;cursor:pointer;font-size:14px;}
button:disabled{opacity:.5;cursor:not-allowed;}
.modal{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;align-items:center;justify-content:center;}
.modalBox{background:#fff;width:92%;max-width:360px;border-radius:14px;padding:16px;}
.modalBox h3{text-align:center;color:#d9365d;margin:0 0 10px;}
.summary{font-size:13px;line-height:1.6;}
.modalBtns{display:flex;gap:10px;margin-top:12px;}
.modalBtns button{flex:1;}
.cancelBtn{background:#ccc;color:#333;}
</style>
</head>

<body>
<div class="container">

<div class="topLogo">
<img src="https://i.postimg.cc/XvXzF7RJ/IMG-20251225-WA0003.jpg">
</div>

<div style="text-align:center;margin-bottom:6px;">
<span class="livePop">üü¢ LIVE BOOKING ACTIVE</span>
</div>

<div class="timerBar" id="timer">‚è≥ Booking closes in 30:00</div>

<h2>Kerala Government Ticket</h2>

<input id="name" placeholder="Full Name">
<input id="mobile" placeholder="Mobile Number">

<select id="state">
  <option value="">Select State</option>
  <option>Kerala</option>
  <option>Tamil Nadu</option>
  <option>Karnataka</option>
  <option>Andhra Pradesh</option>
  <option>Telangana</option>
</select>

<select id="language">
<option>English</option>
<option>Hindi</option>
<option>Malayalam</option>
<option>Tamil</option>
<option>Kannada</option>
<option>Telugu</option>
</select>

<div class="ticketBox">
<div class="ticketAmount" id="ticketAmount">üí∞ Total Amount: ‚Çπ0</div>
<div class="ticketTitle">üéü Select Lucky Ticket (‚Çπ40 per ticket)</div>
<select id="ticket" multiple></select>
<div class="counter" id="counter">Selected: 0 tickets</div>
<div class="selectedList" id="selectedList"></div>
</div>

<input id="amount" placeholder="Total Amount (‚Çπ)" readonly>
<button id="submitBtn" disabled>Submit & Continue</button>

</div>

<div class="modal" id="previewModal">
  <div class="modalBox">
    <h3>Payment Preview</h3>
    <div class="summary" id="previewContent"></div>
    <div class="modalBtns">
      <button class="cancelBtn" onclick="closePreview()">Cancel</button>
      <button onclick="proceedWhatsApp()">Confirm & WhatsApp</button>
    </div>
  </div>
</div>

<script>
let time=1800;
setInterval(()=>{
 let m=Math.floor(time/60),s=time%60;
 document.getElementById("timer").textContent=`‚è≥ Booking closes in ${m}:${s.toString().padStart(2,"0")}`;
 if(time>0) time--;
},1000);

const TICKET_PRICE=40,MIN_TICKETS=3;
const ticket=document.getElementById("ticket"),
selectedList=document.getElementById("selectedList"),
amount=document.getElementById("amount"),
ticketAmount=document.getElementById("ticketAmount"),
submitBtn=document.getElementById("submitBtn"),
counter=document.getElementById("counter"),
language=document.getElementById("language"),
state=document.getElementById("state"),
nameI=document.getElementById("name"),
mobileI=document.getElementById("mobile"),
previewModal=document.getElementById("previewModal"),
previewContent=document.getElementById("previewContent");

for(let i=0;i<3000;i++){
 let n=("000000"+Math.floor(Math.random()*999999)).slice(-6);
 let o=document.createElement("option");
 o.value="KL"+n;o.textContent="KL"+n;
 ticket.appendChild(o);
}

function refresh(){
 let sel=[...ticket.selectedOptions].map(o=>o.value);
 counter.textContent=`Selected: ${sel.length} tickets`;
 selectedList.innerHTML="";
 sel.forEach(t=>{
   let c=document.createElement("div");
   c.className="chip";
   c.innerHTML=`${t} <span onclick="removeTicket('${t}')">√ó</span>`;
   selectedList.appendChild(c);
 });
 if(sel.length>=MIN_TICKETS){
   let total=sel.length*TICKET_PRICE;
   amount.value="‚Çπ "+total;
   ticketAmount.textContent="üí∞ Total Amount: ‚Çπ "+total;
 }else{
   amount.value="";
   ticketAmount.textContent="üí∞ Minimum 3 tickets required";
 }
 submitBtn.disabled=!(sel.length>=3 && nameI.value && mobileI.value && state.value);
}

ticket.addEventListener("change",refresh);
[nameI,mobileI,state].forEach(i=>i.addEventListener("input",refresh));

window.removeTicket=(t)=>{
 [...ticket.options].forEach(o=>{if(o.value===t) o.selected=false;});
 refresh();
};

submitBtn.onclick=()=>{
 let sel=[...ticket.selectedOptions].map(o=>o.value).join(", ");
 previewContent.innerHTML=`
<b>Name:</b> ${nameI.value}<br>
<b>Mobile:</b> ${mobileI.value}<br>
<b>State:</b> ${state.value}<br><br>
<b>Tickets Selected:</b><br>${sel}<br><br>
<b>Total Tickets:</b> ${ticket.selectedOptions.length}<br>
<b>Price per Ticket:</b> ‚Çπ40<br>
<b>Total Amount:</b> ${amount.value}<br><br>
<b>Payment Mode:</b> WhatsApp Confirmation<br>
‚ö†Ô∏è Please verify details before proceeding.
 `;
 previewModal.style.display="flex";
};

function closePreview(){previewModal.style.display="none";}

function proceedWhatsApp(){
 let tickets=[...ticket.selectedOptions].map(o=>o.value).join(", ");
 let msg=`New Booking
Name: ${nameI.value}
Mobile: ${mobileI.value}
State: ${state.value}

Tickets:
${tickets}

Total Tickets: ${ticket.selectedOptions.length}
Amount: ${amount.value}
Language: ${language.value}`;
 window.open("https://wa.me/+12892627399?text="+encodeURIComponent(msg),"_blank");
 previewModal.style.display="none";
}
</script>
</body>
</html>